@model RegisterVM
@{
    ViewData["Title"] = "Đăng ký";
}

<div class="container">
    <div class="order-block__title justify-content-center pt-4 pb-2">
        <h3 class="text-uppercase">Đăng ký</h3>
    </div>
    <div class="auth auth-forgotpass">
        <div>
            <form asp-area="Identity" asp-controller="Account" asp-action="Register" method="post" asp-route-returnurl="@ViewData["ReturnUrl"]" class="row">
                <div asp-validation-summary="ModelOnly" class="text-danger mb-2 alert alert-danger"></div>
                <div class="col-md-6 col-sm-6 col-xs-12">
                    <div class="register-summary__overview">
                        <h4>Thông tin khách hàng</h4>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <div class="form-group">
                                <label>Họ:<span>*</span></label>
                                <input asp-for="FirstName" type="text"
                                       class="form-control"
                                       placeholder="Họ..."
                                       autofocus />
                                <span asp-validation-for="FirstName" class="text-danger small"></span>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <div class="form-group">
                                <label>Tên:<span>*</span></label>
                                <input asp-for="LastName" type="text"
                                       class="form-control"
                                       placeholder="Tên..." />
                                <span asp-validation-for="LastName" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <div class="form-group">
                                <label>Email:<span>*</span></label>
                                <input asp-for="Email" type="text"
                                       class="form-control"
                                       placeholder="Email..." />
                                <span asp-validation-for="Email" class="text-danger small"></span>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <div class="form-group">
                                <label>Điện thoại:<span>*</span></label>
                                <input asp-for="PhoneNumber" type="text"
                                       class="form-control"
                                       placeholder="Điện thoại..." />
                                <span asp-validation-for="PhoneNumber" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <div class="form-group">
                                <label>Ngày sinh:<span>*</span></label>
                                <input asp-for="BirthDay" type="date"
                                       class="form-control"
                                       placeholder="Ngày sinh..." />
                                <span asp-validation-for="BirthDay" class="text-danger small"></span>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <div class="form-group">
                                <label>Giới tính<span>*</span></label>
                                <select asp-for="Gender" class="form-control">
                                    <option value="Female">Nữ</option>
                                    <option value="Male">Nam</option>
                                    <option value="Other">Khác</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <div class="form-group">
                                <label>Tỉnh/TP:<span>*</span></label>
                                <select asp-for="CityCode" class="form-control" id="cities">
                                    <option value="">Chọn Tỉnh/Tp</option>
                                </select>
                                <span asp-validation-for="CityCode" class="text-danger small"></span>
                            </div>
                        </div>
                        <div class="col-md-6 col-sm-6 col-xs-12">
                            <div class="form-group">
                                <label>Quận/Huyện:<span>*</span></label>
                                <select asp-for="DistrictCode" class="form-control" id="districts">
                                    <option value="">Chọn Quận/Huyện</option>
                                </select>
                                <span asp-validation-for="DistrictCode" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <div class="form-group">
                                <label>Phường/Xã:<span>*</span></label>
                                <select asp-for="WardCode" class="form-control" id="wards">
                                    <option value="">Chọn Phường/Xã</option>
                                </select>
                                <span asp-validation-for="WardCode" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <div class="form-group">
                                <label>Địa chỉ:<span>*</span></label>
                                <textarea asp-for="Address" class="form-control"></textarea>
                                <span asp-validation-for="Address" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6 col-sm-6 col-xs-12">
                    <div class="register-summary__overview">
                        <h4>Thông tin mật khẩu</h4>
                    </div>
                    <div class="row">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <div class="form-group">
                                <label>Mật khẩu:<span>*</span></label>
                                <input asp-for="Password" class="form-control"
                                       type="password"
                                       placeholder="Mật khẩu..." />
                                <span asp-validation-for="Password" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <div class="form-group">
                                <label>Nhập lại mật khẩu:<span>*</span></label>
                                <input asp-for="ConfirmPassword" class="form-control"
                                       type="password"
                                       placeholder="Nhập lại mật khẩu..." />
                                <span asp-validation-for="ConfirmPassword" class="text-danger small"></span>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <div class="form-check">
                                <input asp-for="CustomerAgree" class="form-check-input checkboxs"
                                       type="checkbox"
                                       id="defaultCheck1" />
                                <label class="form-check-label user-select-none" for="defaultCheck1">
                                    <span>
                                        Đồng ý với các
                                        <a href="#">điều khoản</a>
                                        của IVY
                                    </span>
                                </label>
                                <span class="text-danger small d-block"></span>
                            </div>
                        </div>
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <div class="form-check">
                                <input asp-for="CustomerSubscribe" class="form-check-input checkboxs"
                                       type="checkbox"
                                       id="defaultCheck2" />
                                <label class="form-check-label user-select-none" for="defaultCheck2">
                                    <span>Đăng ký nhận bản tin</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 col-sm-12 col-xs-12">
                            <button id="btn-register"
                                    class="btn btn--large"
                                    type="submit"
                                    style="width: 100%; margin-top: 15px">
                                Đăng ký
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    <script>
        $(document).ready(function () {
            $("#defaultCheck1").change(function () {
                if(!$(this).is(":checked")) {
                    $("#defaultCheck1").siblings().last().text("Vui lòng đồng ý với các điều khoản");
                }
                else {
                    $("#defaultCheck1").siblings().last().text("");
                }
            })

            $("#btn-register").click(function () {
                if (!$("#defaultCheck1").is(":checked")) {
                    $("#defaultCheck1").siblings().last().text("Vui lòng đồng ý với các điều khoản");
                }
                else {
                    $("#defaultCheck1").siblings().last().text("");
                }
            });
        });
    </script>
    <script>
        $(function () {
            $.ajax({
                type: "GET",
                url: "@Url.Action("GetLocation", "Account")",
                success: function (data) {
                    var location = $.parseJSON(data);
                    var cities = location.map(item => item);
                    var citySelect = $("#cities");

                    location.forEach(item => {
                        var option = $('<option>').val(item.code).text(item.name);
                        $("#cities").append(option);
                    });

                    $("#cities").change(function () {
                        let districts = location.find(item => item.code == $(this).val())?.districts;

                        $("#districts").empty();
                        let districtOption = $('<option>').val(0).text("Chọn Quận/Huyện");
                        $("#districts").append(districtOption);

                        $("#wards").empty();
                        let wardsOption = $('<option>').val(0).text("Chọn Phường/Xã");
                        $("#wards").append(wardsOption);

                        districts?.forEach(item => {
                            var option = $('<option>').val(item.code).text(item.name);
                            $("#districts").append(option);
                        });
                    });

                    $("#districts").change(function () {
                        let districts = location.find(item => item.code == $("#cities").val())?.districts;
                        let wards = districts.find(item => item.code == $(this).val())?.wards;

                        $("#wards").empty();
                        let optionFirst = $('<option>').val(0).text("Chọn Phường/Xã");
                        $("#wards").append(optionFirst);

                        wards?.forEach(item => {
                            var option = $('<option>').val(item.code).text(item.name);
                            $("#wards").append(option);
                        });
                    });
                },
                error: function () {
                    console.log("Lỗi")
                }
            })
        })
    </script>
}